{% extends 'base.html' %}
{% load static %}

{% block title %}Advanced 3D Anatomy Explorer - MediStreak{% endblock %}

{% block extra_css %}
<style>
    body {
        background: #f8f9fa;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    .header-section {
        background: linear-gradient(135deg, #4a90e2 0%, #357abd 100%);
        color: white;
        padding: 40px 0;
        margin-bottom: 0;
    }

    .search-section {
        background: white;
        padding: 20px 0;
        border-bottom: 1px solid #e9ecef;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .search-container {
        display: flex;
        align-items: center;
        gap: 15px;
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 20px;
    }

    .search-box {
        flex: 1;
        position: relative;
    }

    .search-input {
        width: 100%;
        padding: 12px 45px 12px 15px;
        border: 2px solid #e9ecef;
        border-radius: 8px;
        font-size: 16px;
        transition: border-color 0.3s ease;
    }

    .search-input:focus {
        outline: none;
        border-color: #4a90e2;
        box-shadow: 0 0 0 3px rgba(74, 144, 226, 0.1);
    }

    .search-icon {
        position: absolute;
        right: 15px;
        top: 50%;
        transform: translateY(-50%);
        color: #6c757d;
    }

    .filter-dropdown {
        position: relative;
    }

    .filter-btn {
        background: white;
        border: 2px solid #e9ecef;
        padding: 12px 20px;
        border-radius: 8px;
        cursor: pointer;
        font-size: 16px;
        display: flex;
        align-items: center;
        gap: 8px;
        transition: all 0.3s ease;
    }

    .filter-btn:hover {
        border-color: #4a90e2;
    }

    .sort-controls {
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .sort-select {
        padding: 8px 12px;
        border: 1px solid #e9ecef;
        border-radius: 6px;
        background: white;
    }

    .anatomy-tabs {
        background: white;
        border-bottom: 1px solid #e9ecef;
        padding: 0 20px;
    }

    .tab-container {
        display: flex;
        max-width: 1200px;
        margin: 0 auto;
        overflow-x: auto;
    }

    .tab-btn {
        padding: 15px 25px;
        border: none;
        background: none;
        cursor: pointer;
        font-size: 16px;
        font-weight: 500;
        color: #6c757d;
        border-bottom: 3px solid transparent;
        transition: all 0.3s ease;
        white-space: nowrap;
    }

    .tab-btn:hover {
        color: #4a90e2;
    }

    .tab-btn.active {
        color: #4a90e2;
        border-bottom-color: #4a90e2;
    }

    .content-area {
        max-width: 1200px;
        margin: 0 auto;
        padding: 30px 20px;
    }

    .anatomy-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
        gap: 20px;
        margin-top: 20px;
    }

    .anatomy-card {
        background: white;
        border-radius: 12px;
        overflow: hidden;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        transition: all 0.3s ease;
        border: 1px solid #e9ecef;
    }

    .anatomy-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
    }

     .card-image {
        position: relative;
        width: 100%;
        height: 200px;
        border-bottom: 1px solid #e9ecef;
        background: linear-gradient(45deg, #f8f9fa 0%, #e9ecef 100%);
        overflow: hidden;
    }

    .model-thumbnail {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        object-fit: cover;
        display: block;
        transition: transform 0.3s ease;
    }

    .anatomy-card:hover .model-thumbnail {
        transform: scale(1.05);
    }

    .card-image i {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        font-size: 48px;
        color: #6c757d;
        z-index: 1;
        display: none;
    }

    .card-content {
        padding: 20px;
    }

    .card-title {
        font-size: 18px;
        font-weight: 600;
        color: #2c3e50;
        margin-bottom: 8px;
    }

    .card-description {
        color: #6c757d;
        font-size: 14px;
        line-height: 1.4;
        margin-bottom: 15px;
    }

    .card-tags {
        display: flex;
        gap: 8px;
        margin-bottom: 15px;
    }

    .tag {
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 12px;
        font-weight: 500;
    }

    .tag-system {
        background: #e3f2fd;
        color: #1976d2;
    }

    .tag-complexity {
        background: #fff3e0;
        color: #f57c00;
    }

    .tag-complexity.beginner {
        background: #e8f5e8;
        color: #2e7d32;
    }

    .tag-complexity.advanced {
        background: #fce4ec;
        color: #c2185b;
    }

    .tag-complexity.expert {
        background: #ffebee;
        color: #d32f2f;
    }

    .view-btn {
        width: 100%;
        padding: 10px;
        background: #4a90e2;
        color: white;
        border: none;
        border-radius: 6px;
        font-size: 14px;
        font-weight: 500;
        cursor: pointer;
        transition: background 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
    }

    .view-btn:hover {
        background: #357abd;
    }

    .model-viewer-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.8);
        z-index: 1000;
        display: none;
        align-items: center;
        justify-content: center;
    }

    .model-viewer-container {
        background: white;
        border-radius: 12px;
        max-width: 90%;
        max-height: 90%;
        width: 1000px;
        height: 700px;
        display: flex;
        flex-direction: column;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
    }

    .model-viewer-header {
        padding: 20px;
        border-bottom: 1px solid #e9ecef;
        display: flex;
        justify-content: between;
        align-items: center;
    }

    .model-viewer-title {
        font-size: 24px;
        font-weight: 600;
        color: #2c3e50;
        margin: 0;
    }

    .close-btn {
        background: #6c757d;
        color: white;
        border: none;
        padding: 8px 16px;
        border-radius: 6px;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 8px;
        margin-left: auto;
    }

    .close-btn:hover {
        background: #5a6268;
    }

    .model-viewer-content {
        flex: 1;
        padding: 20px;
        display: flex;
        flex-direction: column;
    }

    .sketchfab-wrapper {
        flex: 1;
        border-radius: 8px;
        overflow: hidden;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }

    .sketchfab-wrapper iframe {
        width: 100%;
        height: 100%;
        border: none;
    }

    .model-info {
        display: flex;
        gap: 20px;
        margin-top: 20px;
        padding-top: 20px;
        border-top: 1px solid #e9ecef;
    }

    .info-item {
        flex: 1;
    }

    .info-label {
        font-weight: 600;
        color: #2c3e50;
        margin-bottom: 4px;
    }

    .info-value {
        color: #6c757d;
    }

    .loading-state {
        text-align: center;
        padding: 60px 20px;
        color: #6c757d;
    }

    .no-results {
        text-align: center;
        padding: 60px 20px;
        color: #6c757d;
    }

    .no-results i {
        font-size: 48px;
        margin-bottom: 20px;
        opacity: 0.5;
    }

    @media (max-width: 768px) {
        .search-container {
            flex-direction: column;
            gap: 15px;
        }

        .anatomy-grid {
            grid-template-columns: 1fr;
        }

        .tab-container {
            padding: 0 10px;
        }

        .model-viewer-container {
            width: 95%;
            height: 80%;
        }
    }
</style>
{% endblock %}

{% block content %}
<!-- Header Section -->
<div class="header-section">
    <div class="container text-center">
        <h1 class="display-4 mb-3">ðŸ§¬ Advanced 3D Anatomy Explorer</h1>
        <p class="lead mb-0">Explore detailed 3D anatomical models for comprehensive learning</p>
    </div>
</div>

<!-- Search Section -->
<div class="search-section">
    <div class="search-container">
        <div class="search-box">
            <input type="text" 
                   class="search-input" 
                   placeholder="Search Anatomy for Medical Studies..."
                   id="searchInput"
                   oninput="filterModels()">
            <i class="fas fa-search search-icon"></i>
        </div>
        
        <div class="filter-dropdown">
            <button class="filter-btn" onclick="toggleFilter()">
                <i class="fas fa-filter"></i>
                Filter
                <i class="fas fa-chevron-down"></i>
            </button>
        </div>
        
        <div class="sort-controls">
            <span>Sort:</span>
            <select class="sort-select" id="sortSelect" onchange="sortModels()">
                <option value="relevance">Relevance</option>
                <option value="name">Name</option>
                <option value="complexity">Complexity</option>
                <option value="system">System</option>
            </select>
        </div>
    </div>
</div>

<!-- Anatomy Tabs -->
<div class="anatomy-tabs">
    <div class="tab-container">
        <button class="tab-btn active" onclick="selectTab('all')">All Systems</button>
        <button class="tab-btn" onclick="selectTab('cardiovascular')">Cardiovascular</button>
        <button class="tab-btn" onclick="selectTab('respiratory')">Respiratory</button>
        <button class="tab-btn" onclick="selectTab('digestive')">Digestive</button>
        <button class="tab-btn" onclick="selectTab('skeletal')">Skeletal</button>
        <button class="tab-btn" onclick="selectTab('nervous')">Nervous</button>
        <button class="tab-btn" onclick="selectTab('urinary')">Urinary</button>
        <button class="tab-btn" onclick="selectTab('muscular')">Muscular</button>
        <button class="tab-btn" onclick="selectTab('circulatory')">Circulatory</button>
    </div>
</div>

<!-- Content Area -->
<div class="content-area">
    <div class="anatomy-grid" id="anatomyGrid">
        <!-- Loading state -->
        <div class="loading-state" id="loadingState">
            <i class="fas fa-spinner fa-spin fa-2x mb-3"></i>
            <p>Loading anatomy models...</p>
        </div>
    </div>
</div>

<!-- Model Viewer Overlay -->
<div class="model-viewer-overlay" id="modelViewerOverlay">
    <div class="model-viewer-container">
        <div class="model-viewer-header">
            <h2 class="model-viewer-title" id="modelViewerTitle">Model Title</h2>
            <button class="close-btn" onclick="closeModelViewer()">
                <i class="fas fa-times"></i>
                Close
            </button>
        </div>
        <div class="model-viewer-content">
            <div class="sketchfab-wrapper" id="sketchfabWrapper">
                <!-- Sketchfab embed will be loaded here -->
            </div>
            <div class="model-info">
                <div class="info-item">
                    <div class="info-label">System</div>
                    <div class="info-value" id="modelSystem">-</div>
                </div>
                <div class="info-item">
                    <div class="info-label">Complexity</div>
                    <div class="info-value" id="modelComplexity">-</div>
                </div>
                <div class="info-item">
                    <div class="info-label">Description</div>
                    <div class="info-value" id="modelDescription">-</div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>

    // Set base path for thumbnails
const THUMBNAIL_BASE_PATH = "{% static 'images/anatomy_thumbnails/' %}";

// Enhanced anatomy models data
const anatomyModels = {
    cardiovascular: [
        {
            title: "Heart Anatomy and Functions",
            description: "Detailed 3D model of the human heart showing all chambers, valves, and major vessels with interactive features.",
            complexity: "advanced",
            system: "cardiovascular",
            icon: "fas fa-heart",
            modelId: "2e6726aca3e64c56b8f8d7cceae17a28",
            embedUrl: "https://sketchfab.com/models/2e6726aca3e64c56b8f8d7cceae17a28/embed",
            modelUrl: "https://sketchfab.com/3d-models/heart-anatomy-and-functions-2e6726aca3e64c56b8f8d7cceae17a28",
            author: "luismi93",
            authorUrl: "https://sketchfab.com/luismi93",
            thumbnailFile: "heart_anatomy.png"
        },
        {
            title: "Cardiac Veins of the Heart",
            description: "Detailed 3D model highlighting the cardiac venous system, including major coronary veins involved in heart drainage.",
            complexity: "expert",
            system: "cardiovascular",
            icon: "fas fa-heart",
            modelId: "faa6c5b169ec4928bda1f6bf36e0fcb6",
            embedUrl: "https://sketchfab.com/models/faa6c5b169ec4928bda1f6bf36e0fcb6/embed",
            modelUrl: "https://sketchfab.com/3d-models/cardiac-anatomy-cardiac-veins-of-the-heart-faa6c5b169ec4928bda1f6bf36e0fcb6",
            author: "HannahNewey",
            authorUrl: "https://sketchfab.com/HannahNewey",
            thumbnailFile: "cardiac_veins.png"
        },

       {
    title: "Nervous and Cardiovascular System",
    description: "Integrated 3D model showing both the human nervous system and cardiovascular system, illustrating their spatial relationships.",
    complexity: "expert",
    system: "combined: nervous + cardiovascular",
    icon: "fas fa-user-md",
    modelId: "0a9c32d586ba4493ae61f90af4fb102d",
    embedUrl: "https://sketchfab.com/models/0a9c32d586ba4493ae61f90af4fb102d/embed",
    modelUrl: "https://sketchfab.com/3d-models/human-nervous-and-cardiovascular-system-0a9c32d586ba4493ae61f90af4fb102d",
    author: "AERO3D",
    authorUrl: "https://sketchfab.com/aero3d.ua",
    thumbnailFile:"nervous_cardi.png"
}

    ],
    respiratory: [
    
    {
    title: "Human Respiratory System Review",
    description: "Comprehensive 3D model of the human respiratory system, including lungs, trachea, and associated structures for educational review.",
    complexity: "intermediate",
    system: "respiratory",
    icon: "fas fa-lungs",
    modelId: "250911151757489da1cf5501b791f363",
    embedUrl: "https://sketchfab.com/models/250911151757489da1cf5501b791f363/embed",
    modelUrl: "https://sketchfab.com/3d-models/human-respiratory-system-review-250911151757489da1cf5501b791f363",
    author: "Darmawan Pujisetyadi",
    authorUrl: "https://sketchfab.com/shinjou",
    thumbnailFile: "respitotary.png"
},
    
    {
    title: "Lungs anatomy and Functions",
    description: "Detailed 3D model of lungs showing anatomical structures and functions in the respiratory system.",
    complexity: "intermediate",
    system: "respiratory",
    icon: "fas fa-lungs",
    modelId: "50c877863fe64d11a55044afb79f5664",
    embedUrl: "https://sketchfab.com/models/50c877863fe64d11a55044afb79f5664/embed",
    modelUrl: "https://sketchfab.com/3d-models/lungs-anatomy-and-functions-50c877863fe64d11a55044afb79f5664",
    author: "luismi93",
    authorUrl: "https://sketchfab.com/luismi93",
    thumbnailFile: "lungs.png"
},

       {
    title: "Fetus Lungs (Week Sixteen)",
    description: "3D model of fetal lungs at 16 weeks gestation, showing early development within the respiratory system.",
    complexity: "intermediate",
    system: "respiratory, developmental",
    icon: "fas fa-lungs",
    modelId: "3aae6de354ac4506a12425027a39bc20",
    embedUrl: "https://sketchfab.com/models/3aae6de354ac4506a12425027a39bc20/embed",
    modelUrl: "https://sketchfab.com/3d-models/fetus-lungs-week-sixteen-3aae6de354ac4506a12425027a39bc20",
    author: "Ebers",
    authorUrl: "https://sketchfab.com/Ebers",
    thumbnailFile: "fitus_lungs.png"
},
{
    title: "Nasal Pharynx Dissection (Head)",
    description: "Detailed dissection model showing the nasal cavity and pharynx, providing insight into upper respiratory and head anatomy.",
    complexity: "expert",
    system: "respiratory",
    icon: "fas fa-head-side-mask",
    modelId: "d473f515f4844a3a9b835528f2cd0a7d",
    embedUrl: "https://sketchfab.com/models/d473f515f4844a3a9b835528f2cd0a7d/embed",
    modelUrl: "https://sketchfab.com/3d-models/nasal-pharynx-dissection-head-d473f515f4844a3a9b835528f2cd0a7d",
    author: "flarar-01",
    authorUrl: "https://sketchfab.com/flarar"
}

    ],
    digestive: [

    {
    title: "Digestive System",
    description: "Comprehensive 3D model of the adult human digestive system, including the esophagus, stomach, intestines, and accessory organs.",
    complexity: "intermediate",
    system: "digestive",
    icon: "fas fa-stomach",
    modelId: "bfe2c671298947f8bcf0f69c06e74ed8",
    embedUrl: "https://sketchfab.com/models/bfe2c671298947f8bcf0f69c06e74ed8/embed",
    modelUrl: "https://sketchfab.com/3d-models/adult-digestive-system-bfe2c671298947f8bcf0f69c06e74ed8",
    author: "Education Resource Fund",
    authorUrl: "https://sketchfab.com/bobsmusail"
    },

    {
    title: "Fetus Liver, Spleen & Pancreas",
    description: "3D visualization of fetal digestive and immune organs at 16 weeks, including the liver, spleen, and pancreas.",
    complexity: "intermediate",
    system: "digestive",
    icon: "fas fa-baby",
    modelId: "233d2d19f9b74f00867309a9275c0466",
    embedUrl: "https://sketchfab.com/models/233d2d19f9b74f00867309a9275c0466/embed",
    modelUrl: "https://sketchfab.com/3d-models/fetus-liver-spleen-pancreas-week-sixteen-233d2d19f9b74f00867309a9275c0466",
    author: "Ebers",
    authorUrl: "https://sketchfab.com/Ebers"
},
 {
    title: "Small and Large Intestine",
    description: "Detailed 3D model of the human small and large intestines, showing the structure and arrangement within the digestive system.",
    complexity: "intermediate",
    system: "digestive",
    icon: "fas fa-stomach",
    modelId: "8a1ca8e3ca224cdeb9264674416bde38",
    embedUrl: "https://sketchfab.com/models/8a1ca8e3ca224cdeb9264674416bde38/embed",
    modelUrl: "https://sketchfab.com/3d-models/small-and-large-intestine-8a1ca8e3ca224cdeb9264674416bde38",
    author: "antonia.sundberg",
    authorUrl: "https://sketchfab.com/antonia.sundberg"
},

   {
    title: "Stomach and Esophagus",
    description: "Anatomical 3D model showing the structure and connection between the esophagus and stomach within the upper digestive tract.",
    complexity: "intermediate",
    system: "digestive",
    icon: "fas fa-stomach",
    modelId: "bbe2dc2fe56d49a9a84d4f954cee706b",
    embedUrl: "https://sketchfab.com/models/bbe2dc2fe56d49a9a84d4f954cee706b/embed",
    modelUrl: "https://sketchfab.com/3d-models/stomach-and-esophagus-bbe2dc2fe56d49a9a84d4f954cee706b",
    author: "Ebers",
    authorUrl: "https://sketchfab.com/Ebers"
}


    ],
    nervous: [
        {
    title: "The Nervous System",
    description: "A comprehensive 3D model illustrating the human nervous system including the brain, spinal cord, and peripheral nerves.",
    complexity: "expert",
    system: "nervous",
    icon: "fas fa-brain",
    modelId: "2e6be1399756494b9f185ce8c5900911",
    embedUrl: "https://sketchfab.com/models/2e6be1399756494b9f185ce8c5900911/embed",
    modelUrl: "https://sketchfab.com/3d-models/the-nervous-system-2e6be1399756494b9f185ce8c5900911",
    author: "University of Dundee, CAHID",
    authorUrl: "https://sketchfab.com/anatomy_dundee"
},
        {
    title: "Circle of Willis: Arteries of Brain",
    description: "Animated 3D model illustrating the Circle of Willisâ€”an arterial ring at the base of the brain critical for cerebral blood flow.",
    complexity: "expert",
    system: "nervous",
    icon: "fas fa-brain",
    modelId: "25e3f5851d5044ffb333bd852a86f238",
    embedUrl: "https://sketchfab.com/models/25e3f5851d5044ffb333bd852a86f238/embed",
    modelUrl: "https://sketchfab.com/3d-models/circle-of-willis-arteries-of-brain-animated-25e3f5851d5044ffb333bd852a86f238",
    author: "Anatomy by Doctor Jana",
    authorUrl: "https://sketchfab.com/docjana"
},

        {
    title: "Human Brain",
    description: "A detailed 3D model of the human brain for anatomical study.",
    complexity: "expert",
    system: "nervous",
    icon: "fas fa-brain",
    modelId: "f5177aa5722a46e286114b155a4a3490",
    embedUrl: "https://sketchfab.com/models/f5177aa5722a46e286114b155a4a3490/embed",
    modelUrl: "https://sketchfab.com/3d-models/human-brain-f5177aa5722a46e286114b155a4a3490",
    author: "Leotide",
    authorUrl: "https://sketchfab.com/Leotide"
},

{
    title: "Neurons",
    description: "Detailed 3D model of neurons showcasing their structure, including dendrites, axons, and synaptic connections within the nervous system.",
    complexity: "intermediate",
    system: "nervous",
    icon: "fas fa-brain",
    modelId: "20e930a5fae5457fa6d1738afa00c7bb",
    embedUrl: "https://sketchfab.com/models/20e930a5fae5457fa6d1738afa00c7bb/embed",
    modelUrl: "https://sketchfab.com/3d-models/neurons-20e930a5fae5457fa6d1738afa00c7bb",
    author: "Guillem Font",
    authorUrl: "https://sketchfab.com/guillemfont"
}

    ],

circulatory: [
       {
    title: "Circulatory System",
    description: "An animated full-body model showing the circulatory system, including the heart and blood vessels, in motion.",
    complexity: "intermediate",
    system: "circulatory",
    icon: "fas fa-heartbeat",
    modelId: "6a7a537a71444f6e8201e18a685a013d",
    embedUrl: "https://sketchfab.com/models/6a7a537a71444f6e8201e18a685a013d/embed",
    modelUrl: "https://sketchfab.com/3d-models/animated-human-body-with-circulatory-system-6a7a537a71444f6e8201e18a685a013d",
    author: "AVRcontent",
    authorUrl: "https://sketchfab.com/AVRcontent"
},

         {
    title: "Brain Blood Supply",
    description: "Detailed 3D visualization of the arterial blood supply to the human brain, highlighting key vessels involved in cerebral circulation.",
    complexity: "expert",
    system: "circulatory",
    icon: "fas fa-brain",
    modelId: "93547975326f46eea422894b9a85f3ef",
    embedUrl: "https://sketchfab.com/models/93547975326f46eea422894b9a85f3ef/embed",
    modelUrl: "https://sketchfab.com/3d-models/brain-blood-supply-93547975326f46eea422894b9a85f3ef",
    author: "1225659838@qq.com",
    authorUrl: "https://sketchfab.com/Novaky"
},

{
    title: "Blood Vessel Anatomy",
    description: "3D anatomical model showing the structure and branching of human blood vessels, highlighting arteries and veins in the circulatory system.",
    complexity: "intermediate",
    system: "circulatory",
    icon: "fas fa-heartbeat",
    modelId: "29ac5461ef1745fb8d92f69d92d52d7d",
    embedUrl: "https://sketchfab.com/models/29ac5461ef1745fb8d92f69d92d52d7d/embed",
    modelUrl: "https://sketchfab.com/3d-models/blood-vessel-anatomy-29ac5461ef1745fb8d92f69d92d52d7d",
    author: "Nima",
    authorUrl: "https://sketchfab.com/h3ydari96"
},
        {
    title: "Obturator Artery Variant Origin",
    description: "3D model showing the anatomical variant origin of the obturator artery, part of the circulatory system.",
    complexity: "intermediate",
    system: "circulatory",
    icon: "fas fa-heartbeat",
    modelId: "087721ac5b7f4ef0b2e8e651f68f9511",
    embedUrl: "https://sketchfab.com/models/087721ac5b7f4ef0b2e8e651f68f9511/embed",
    modelUrl: "https://sketchfab.com/3d-models/obturator-artery-variant-origin-087721ac5b7f4ef0b2e8e651f68f9511",
    author: "University of Dundee, CAHID",
    authorUrl: "https://sketchfab.com/anatomy_dundee"
}


    ],

    skeletal: [

        {
    title: "Human Skeleton",
    description: "Detailed 3D model of the human skeleton showcasing all major bones and joints of the skeletal system.",
    complexity: "intermediate",
    system: "skeletal",
    icon: "fas fa-bone",
    modelId: "acf6b25134d945f8b0bc8ae5e04861df",
    embedUrl: "https://sketchfab.com/models/acf6b25134d945f8b0bc8ae5e04861df/embed",
    modelUrl: "https://sketchfab.com/3d-models/human-skeleton-acf6b25134d945f8b0bc8ae5e04861df",
    author: "Versal",
    authorUrl: "https://sketchfab.com/versal"
},

        {
    title: "Ligaments of the Craniovertebral Joints",
    description: "Detailed 3D model showing the ligaments connecting the skull and cervical spine, highlighting the craniovertebral joint anatomy.",
    complexity: "expert",
    system: "skeletal",
    icon: "fas fa-bone",
    modelId: "ee7bbcc2452f4fc4b0ad715145b532a8",
    embedUrl: "https://sketchfab.com/models/ee7bbcc2452f4fc4b0ad715145b532a8/embed",
    modelUrl: "https://sketchfab.com/3d-models/ligaments-of-the-craniovertebral-joints-ee7bbcc2452f4fc4b0ad715145b532a8",
    author: "JenniferNRSmith",
    authorUrl: "https://sketchfab.com/JennyNRSmith"
},

        {
    title: "Foot bones",
    description: "3D anatomical model detailing the bones of the human foot, showcasing skeletal structure and articulation.",
    complexity: "intermediate",
    system: "skeletal",
    icon: "fas fa-bone",
    modelId: "f3d70fa91a69465db13ae1f018338642",
    embedUrl: "https://sketchfab.com/models/f3d70fa91a69465db13ae1f018338642/embed",
    modelUrl: "https://sketchfab.com/3d-models/foot-bones-f3d70fa91a69465db13ae1f018338642",
    author: "pizawl",
    authorUrl: "https://sketchfab.com/pizawl"
},

        
        {
    title: "Anterior Cervical Triangle Dissection",
    description: "Detailed 3D dissection of the anterior cervical triangle, highlighting muscular and vascular anatomy.",
    complexity: "intermediate",
    system: "musculoskeletal",
    icon: "fas fa-bone",
    modelId: "da94d904d80347ec84690ca606e5ce23",
    embedUrl: "https://sketchfab.com/models/da94d904d80347ec84690ca606e5ce23/embed",
    modelUrl: "https://sketchfab.com/3d-models/anterior-cervical-triangle-dissection-da94d904d80347ec84690ca606e5ce23",
    author: "UBC Medicine - Educational Media",
    authorUrl: "https://sketchfab.com/UBC.MEDVID"
},

{
    title: "Animation Skeletal Anatomy Systems: RUNING",
    description: "Animated 3D skeletal anatomy showing the human skeleton in running motion, illustrating bone movement and joint articulation.",
    complexity: "expert",
    system: "skeletal",
    icon: "fas fa-bone",
    modelId: "2f5e0a60c824470bade4d39b049aae9f",
    embedUrl: "https://sketchfab.com/models/2f5e0a60c824470bade4d39b049aae9f/embed",
    modelUrl: "https://sketchfab.com/3d-models/animation-skeletal-anatomy-systems-runing-2f5e0a60c824470bade4d39b049aae9f",
    author: "flarar-01",
    authorUrl: "https://sketchfab.com/flarar"
}

    ],

    urinary: [

    {
    title: "Kidneys - Urinary System",
    description: "3D model showing kidneys and related urinary system anatomy in detail.",
    complexity: "intermediate",
    system: "urinary",
    icon: "fas fa-kidneys",
    modelId: "03d325c81aaa4dfabb74b727fec0a1a4",
    embedUrl: "https://sketchfab.com/models/03d325c81aaa4dfabb74b727fec0a1a4/embed",
    modelUrl: "https://sketchfab.com/3d-models/kidneys-urinary-system-03d325c81aaa4dfabb74b727fec0a1a4",
    author: "Cos",
    authorUrl: "https://sketchfab.com/CostaP"
},
        {
    title: "Nephroptosis Kidney Anatomy Model",
    description: "A 3D anatomical model demonstrating nephroptosis, a condition involving the abnormal descent of the kidney.",
    complexity: "intermediate",
    system: "urinary",
    icon: "fas fa-procedures",
    modelId: "1fb2ea2ba18241b3be8affbcce5cd364",
    embedUrl: "https://sketchfab.com/models/1fb2ea2ba18241b3be8affbcce5cd364/embed",
    modelUrl: "https://sketchfab.com/3d-models/nephroptosis-kidney-anatomy-model-1fb2ea2ba18241b3be8affbcce5cd364",
    author: "University of Dundee, CAHID",
    authorUrl: "https://sketchfab.com/anatomy_dundee"
},

{
    title: "Human urinary bladder",
    description: "Detailed 3D model of the human urinary bladder showing anatomy and structure.",
    complexity: "intermediate",
    system: "urinary",
    icon: "fas fa-bladder",
    modelId: "3e96c2e9f3f24bb684fc7c8a874a90d6",
    embedUrl: "https://sketchfab.com/models/3e96c2e9f3f24bb684fc7c8a874a90d6/embed",
    modelUrl: "https://sketchfab.com/3d-models/human-urinary-bladder-3e96c2e9f3f24bb684fc7c8a874a90d6",
    author: "axelserrander",
    authorUrl: "https://sketchfab.com/axelserrander"
}

    ],

    muscular: [
       {
    title: "Ecorche - Anatomy Study",
    description: "An anatomical study showing detailed muscles and posture through a flayed human figure, useful for artists and medical learners.",
    complexity: "intermediate",
    system: "muscular",
    icon: "fas fa-dumbbell",
    modelId: "e402d3d541eb4b199c57d5410f5d3c57",
    embedUrl: "https://sketchfab.com/models/e402d3d541eb4b199c57d5410f5d3c57/embed",
    modelUrl: "https://sketchfab.com/3d-models/ecorche-anatomy-study-e402d3d541eb4b199c57d5410f5d3c57",
    author: "Beatriz Gomez Santamaria",
    authorUrl: "https://sketchfab.com/BeatrizGomez"
},
     
         {
    title: "Skeletal Muscle Structure (Actin & Myosin)",
    description: "3D visualization of skeletal muscle fibers, illustrating the interaction between actin and myosin filaments essential for voluntary muscle contraction.",
    complexity: "intermediate",
    system: "muscular",
    icon: "fas fa-dumbbell",
    modelId: "b86266b76c874de58d59bf3572815541",
    embedUrl: "https://sketchfab.com/models/b86266b76c874de58d59bf3572815541/embed",
    modelUrl: "https://sketchfab.com/3d-models/skeletal-muscle-structure-actin-myosin-b86266b76c874de58d59bf3572815541",
    author: "Ebers",
    authorUrl: "https://sketchfab.com/Ebers"
},
        {
    title: "Cardiac Muscle Cell Anatomy",
    description: "Detailed 3D visualization of a cardiac muscle cell, highlighting its structure and components.",
    complexity: "intermediate",
    system: "muscular",
    icon: "fas fa-dna",
    modelId: "16e33d3b0be74b4c800cb7601fb51dd2",
    embedUrl: "https://sketchfab.com/models/16e33d3b0be74b4c800cb7601fb51dd2/embed",
    modelUrl: "https://sketchfab.com/3d-models/cardiac-muscle-cell-anatomy-16e33d3b0be74b4c800cb7601fb51dd2",
    author: "_Bonehead14",
    authorUrl: "https://sketchfab.com/_Bonehead14"
},

        {
    title: "Smooth Muscle Anatomy",
    description: "Detailed 3D model of smooth muscle tissue, showing cellular structure and fiber orientation relevant to involuntary muscle function.",
    complexity: "intermediate",
    system: "muscular",
    icon: "fas fa-dna",
    modelId: "36cd940cc1b54bbda1cc5961d5e112a6",
    embedUrl: "https://sketchfab.com/models/36cd940cc1b54bbda1cc5961d5e112a6/embed",
    modelUrl: "https://sketchfab.com/3d-models/smooth-muscle-anatomy-36cd940cc1b54bbda1cc5961d5e112a6",
    author: "zames1992",
    authorUrl: "https://sketchfab.com/zames1992"
},
        {
    title: "Anatomy of the Right Thigh Compartments",
    description: "3D model illustrating the muscular and anatomical compartments of the right thigh, including major nerves and vessels.",
    complexity: "advanced",
    system: "muscular",
    icon: "fas fa-drumstick-bite",
    modelId: "ec1fad10b2994afaba7e9fe9212a9ee6",
    embedUrl: "https://sketchfab.com/models/ec1fad10b2994afaba7e9fe9212a9ee6/embed",
    modelUrl: "https://sketchfab.com/3d-models/anatomy-of-the-compartments-of-the-right-thigh-ec1fad10b2994afaba7e9fe9212a9ee6",
    author: "Friso Jansen",
    authorUrl: "https://sketchfab.com/frisojansen"
}

    ]
};
let currentSystem = 'all';

function selectTab(system, buttonElement) {
    currentSystem = system;
    
    // Update tab states
    document.querySelectorAll('.tab-btn').forEach(btn => {
        btn.classList.remove('active');
    });
    buttonElement.classList.add('active');
    
    // Load models for selected system
    loadModels();
}

function loadModels() {
    const gridContainer = document.getElementById('anatomyGrid');
    const loadingState = document.getElementById('loadingState');
    
    // Show loading state
    loadingState.style.display = 'block';
    gridContainer.innerHTML = '';
    gridContainer.appendChild(loadingState);
    
    // Simulate loading delay
    setTimeout(() => {
        let modelsToShow = [];
        
        if (currentSystem === 'all') {
            // Show all models
            Object.keys(anatomyModels).forEach(key => {
                modelsToShow = [...modelsToShow, ...anatomyModels[key]];
            });
        } else {
            // Show models for specific system
            modelsToShow = anatomyModels[currentSystem] || [];
        }
        
        renderModels(modelsToShow);
    }, 500);
}

function renderModels(models) {
    const gridContainer = document.getElementById('anatomyGrid');
    gridContainer.innerHTML = '';
    
    if (models.length === 0) {
        gridContainer.innerHTML = `
            <div class="no-results">
                <i class="fas fa-search"></i>
                <h3>No results found</h3>
                <p>Try adjusting your search or filter criteria</p>
            </div>
        `;
        return;
    }
    
    models.forEach(model => {
        const modelCard = createModelCard(model);
        gridContainer.appendChild(modelCard);
    });
}

function createModelCard(model) {
    const card = document.createElement('div');
    card.className = 'anatomy-card';
    
    const complexityClass = model.complexity;
    const systemCapitalized = model.system.charAt(0).toUpperCase() + model.system.slice(1);
    
    card.innerHTML = `
        <div class="card-image">
            <img src="${THUMBNAIL_BASE_PATH}${model.thumbnailFile}" 
                 alt="${model.title}" 
                 class="model-thumbnail"
                 onerror="this.style.opacity='0'; this.nextElementSibling.style.display='block'">
            <i class="${model.icon}" style="display: none"></i>
        </div>
        <div class="card-content">
            <h3 class="card-title">${model.title}</h3>
            <p class="card-description">${model.description}</p>
            <div class="card-tags">
                <span class="tag tag-system">${systemCapitalized}</span>
                <span class="tag tag-complexity ${complexityClass}">${model.complexity.charAt(0).toUpperCase() + model.complexity.slice(1)}</span>
            </div>
            <button class="view-btn" onclick="openModelViewer('${model.title}', '${model.system}', '${model.description}', '${model.complexity}', '${model.embedUrl}', '${model.modelUrl}', '${model.author}', '${model.authorUrl}', '${model.modelId}')">
                <i class="fas fa-cube"></i>
                View 3D Model
            </button>
        </div>
    `;
    
    return card;

}

function openModelViewer(title, system, description, complexity, embedUrl, modelUrl, author, authorUrl, modelId) {
    // Update model info
    document.getElementById('modelViewerTitle').textContent = title;
    document.getElementById('modelSystem').textContent = system.charAt(0).toUpperCase() + system.slice(1);
    document.getElementById('modelComplexity').textContent = complexity.charAt(0).toUpperCase() + complexity.slice(1);
    document.getElementById('modelDescription').textContent = description;
    
    // Create the Sketchfab embed
    const sketchfabWrapper = document.getElementById('sketchfabWrapper');
    sketchfabWrapper.innerHTML = `
        <iframe title="${title}" 
                frameborder="0" 
                allowfullscreen 
                mozallowfullscreen="true" 
                webkitallowfullscreen="true" 
                allow="autoplay; fullscreen; xr-spatial-tracking" 
                xr-spatial-tracking 
                execution-while-out-of-viewport 
                execution-while-not-rendered 
                web-share 
                src="${embedUrl}">
        </iframe>
        <p style="font-size: 13px; font-weight: normal; margin: 5px; color: #4A4A4A;">
            <a href="${modelUrl}?utm_medium=embed&utm_campaign=share-popup&utm_content=${modelId}" 
               target="_blank" 
               rel="nofollow" 
               style="font-weight: bold; color: #1CAAD9;">
                ${title}
            </a>
            by 
            <a href="${authorUrl}?utm_medium=embed&utm_campaign=share-popup&utm_content=${modelId}" 
               target="_blank" 
               rel="nofollow" 
               style="font-weight: bold; color: #1CAAD9;">
                ${author}
            </a>
            on 
            <a href="https://sketchfab.com?utm_medium=embed&utm_campaign=share-popup&utm_content=${modelId}" 
               target="_blank" 
               rel="nofollow" 
               style="font-weight: bold; color: #1CAAD9;">
                Sketchfab
            </a>
        </p>
    `;
    
    // Show the overlay
    document.getElementById('modelViewerOverlay').style.display = 'flex';
    document.body.style.overflow = 'hidden';
}

function closeModelViewer() {
    document.getElementById('modelViewerOverlay').style.display = 'none';
    document.getElementById('sketchfabWrapper').innerHTML = '';
    document.body.style.overflow = 'auto';
}

function filterModels() {
    const searchTerm = document.getElementById('searchInput').value.toLowerCase();
    let allModels = [];
    
    if (currentSystem === 'all') {
        // Get all models from all systems
        Object.keys(anatomyModels).forEach(key => {
            allModels = [...allModels, ...anatomyModels[key]];
        });
    } else {
        // Get models from current system only
        allModels = anatomyModels[currentSystem] || [];
    }
    
    if (searchTerm === '') {
        renderModels(allModels);
        return;
    }
    
    const filtered = allModels.filter(model => 
        model.title.toLowerCase().includes(searchTerm) ||
        model.description.toLowerCase().includes(searchTerm) ||
        model.system.toLowerCase().includes(searchTerm)
    );
    
    renderModels(filtered);
}
function sortModels() {
    const sortBy = document.getElementById('sortSelect').value;
    let allModels = [];
    
    // Get all models from all systems
    Object.keys(anatomyModels).forEach(key => {
        allModels = [...allModels, ...anatomyModels[key]];
    });
    
    let sorted = [...allModels];
    
    switch (sortBy) {
        case 'name':
            sorted.sort((a, b) => a.title.localeCompare(b.title));
            break;
        case 'complexity':
            const complexityOrder = { 'beginner': 1, 'intermediate': 2, 'advanced': 3, 'expert': 4 };
            sorted.sort((a, b) => complexityOrder[a.complexity] - complexityOrder[b.complexity]);
            break;
        case 'system':
            sorted.sort((a, b) => a.system.localeCompare(b.system));
            break;
        default:
            // Keep original order for relevance
            break;
    }
    
    renderModels(sorted);
}

function toggleFilter() {
    // Placeholder for filter functionality
    alert('Filter functionality can be implemented here');
}

// Close modal when clicking outside
document.getElementById('modelViewerOverlay').addEventListener('click', function(e) {
    if (e.target === this) {
        closeModelViewer();
    }
});

// Initialize the page
document.addEventListener('DOMContentLoaded', function() {
    loadModels();
});
</script>
{% endblock %}